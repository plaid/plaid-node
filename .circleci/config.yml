version: 2

jobs:
  build:
    machine: true
    steps:
      - checkout
      - run:
          name: Download OpenAPI file via Curl from github
          command: make pull-openapi
      - run:
          name: Build generated code using docker cli openapigenerator
          command: make build-openapi
      - run:
          name: Build Docker image for running node tests
          command: docker build -t plaid-node .
      - run:
          name: Run node tests in Docker
          command: docker run --rm -e CLIENT_ID=$CLIENT_ID -e SECRET=$SECRET plaid-node
